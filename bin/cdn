#!/usr/bin/env node

const program = require('commander')
const kleur = require('kleur')
const path = require('path')
const {
  copyFile,
  canCopyFile
} = require('../lib/utils/file')
const { deploy } =  require('../lib')

program
  .version('3.0.0')

program
  .command('init')
  .description(kleur.yellow('初始化'))
  .action(() => {
    canCopyFile('./cdn.config.js').then(() => {
      copyFile(path.resolve(__dirname, '../templates/cdn.config.js'), './cdn.config.js')
    }).catch(() => {
      console.log('cdn.config.js 文件已存在')
    })
  })

program
  .command('deploy <environment>')
  .description(kleur.yellow('上传资源'))
  .action(environment => {
    deploy(environment)
  })

program.on('--help', () => {
  console.log()
  console.log('  例子:')
  console.log()
  console.log('    $ cdn init')
  console.log('    $ cdn deploy development')
})

program.parse(process.argv)
